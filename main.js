(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{W:()=>B,S:()=>N});var t="f1ef085f39d8035f02e38b76",n={url:"https://nomoreparties.co/v1/wbf-cohort-5",headers:{authorization:"73a42daa-c9aa-4a24-beec-5a53978226fa","Content-Type":"application/json"}};function o(e){return e.ok?e.json():Promise.reject("Возникла ошибка: ".concat(e.status))}function r(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function a(e,t,n){t?(e.disabled=!1,e.classList.remove(n.inactiveButtonClass)):(e.disabled=!0,e.classList.add(n.inactiveButtonClass))}var u=document.querySelector(".elements");function i(e,t){t.textContent=e?"Сохранить...":"Сохранить"}function l(e,t){if(isNaN(t))throw new Error("delay должен быть числом");return new Promise((function(n){setTimeout((function(){e(),n()}),t)}))}var s=document.querySelector(".profile__edit-button"),p=document.querySelector(".profile__add-button"),d=document.querySelector(".profile__name"),f=document.querySelector(".profile__profession"),m=document.querySelector(".profile__avatar"),_=document.querySelector(".popup_profile"),h=document.querySelector(".popup_place"),v=document.querySelector(".popup_photo"),y=document.querySelector(".popup_avatar"),b=document.querySelector(".popup__image"),S=document.querySelector(".popup__caption"),q=_.querySelector(".popup__form"),k=q.querySelector(".popup__name"),E=q.querySelector(".popup__description"),L=h.querySelector(".popup__form"),C=L.querySelector(".popup__name"),g=L.querySelector(".popup__description"),w=y.querySelector(".popup__form"),x=w.querySelector(".popup__description"),A=document.querySelector(".popup_place .popup__submit-button"),T=document.querySelector(".popup_profile .popup__submit-button"),P=document.querySelector(".popup_avatar .popup__submit-button");function O(e){var t=function(){e.classList.remove("popup_opened"),window.removeEventListener("keydown",n),e.removeEventListener("click",o)},n=function(e){!0==("Escape"===e.key)&&t()},o=function(e){var n=e.target.classList.contains("popup"),o=e.target.classList.contains("popup__close-button");(n||o)&&t()};e.closePopup=t,e.addEventListener("click",o),window.addEventListener("keydown",n),e.classList.add("popup_opened")}function j(e){e.closePopup()}s.addEventListener("click",(function(){k.value=d.textContent,E.value=f.textContent,a(T,!1,B),i(!1,T),O(_)})),p.addEventListener("click",(function(){a(A,L.checkValidity(),B),i(!1,A),O(h)})),m.addEventListener("click",(function(){a(P,w.checkValidity(),B),i(!1,P),O(y)}));var D=document.querySelector("#element-template").content.querySelector(".elements__item");var N=function(){u.replaceChildren(),fetch("".concat(n.url,"/cards"),{method:"GET",headers:n.headers}).then(o).then((function(e){e.forEach((function(e){var r=function(e){var r=D.cloneNode(!0),c=r.querySelector(".elements__image"),a=r.querySelector(".elements__item-title"),u=r.querySelector(".elements__like-button"),i=r.querySelector(".elements__delete-button"),l=r.querySelector(".elements__like-count");return u.addEventListener("click",(function(){var t;u.classList.contains("elements__like-button_active")?((t=e._id,fetch("".concat(n.url,"/cards/likes/").concat(t),{method:"DELETE",headers:n.headers}).then(o)).then((function(e){return l.textContent=e.likes.length})),u.classList.remove("elements__like-button_active")):(function(e){return fetch("".concat(n.url,"/cards/likes/").concat(e),{method:"PUT",headers:n.headers}).then(o)}(e._id).then((function(e){return l.textContent=e.likes.length})),u.classList.add("elements__like-button_active"))})),c.addEventListener("click",(function(){b.src=e.link,b.alt=e.link,b.title=e.link,S.textContent=e.name,O(v)})),i.addEventListener("click",(function(){var t;r.remove(),t=e._id,fetch("".concat(n.url,"/cards/").concat(t),{method:"DELETE",headers:n.headers}).then(o)})),a.textContent=e.name,c.src=e.link,c.alt=e.name,l.textContent=e.likes.length,e.owner._id!==t&&i.classList.add("elements__delete-button_hidden"),e.likes.forEach((function(e){e._id===t&&u.classList.add("elements__like-button_active")})),r}(e);u.append(r)}))}))};N(),fetch("".concat(n.url,"/users/me"),{method:"GET",headers:n.headers}).then(o).then((function(e){m.src=e.avatar,d.textContent=e.name,f.textContent=e.about})),L.addEventListener("submit",(function(e){var t,r;e.preventDefault(),i(!0,A),a(A,!1,B),(t=C.value,r=g.value,fetch("".concat(n.url,"/cards"),{method:"POST",headers:n.headers,body:JSON.stringify({name:"".concat(t),link:"".concat(r)})}).then(o)).then((function(){return l(N,500)})).catch((function(){return console.error("Ошибка создания карточки")})).finally((function(){return j(h)}))})),q.addEventListener("submit",(function(e){var t,r;e.preventDefault(),i(!0,T),a(T,!1,B),(t=k.value,r=E.value,fetch("".concat(n.url,"/users/me"),{method:"PATCH",headers:n.headers,body:JSON.stringify({name:"".concat(t),about:"".concat(r)})}).then(o)).then((function(e){return l((function(){d.textContent=e.name,f.textContent=e.about}),500)})).catch((function(e){return console.error("Ошибка создания карточки: ".concat(e.status))})).finally((function(){return j(_)}))})),w.addEventListener("submit",(function(e){var t;e.preventDefault(),i(!0,P),a(P,!1,B),(t=x.value,fetch("".concat(n.url,"/users/me/avatar"),{method:"PATCH",headers:n.headers,body:JSON.stringify({avatar:"".concat(t)})}).then(o)).then((function(e){return l((function(){m.src=e.avatar,m.alt=e.name}),500)})).catch((function(e){return console.error("Ошибка создания аватара: ".concat(e.status))})).finally((function(){return j(y)}))}));var B={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button_disabled",inputErrorClass:"popup__input_type_error"};!function(e){r(document.querySelectorAll(e.formSelector)).forEach((function(t){!function(e,t){var n=e.querySelectorAll(t.inputSelector),o=e.querySelector(t.submitButtonSelector);a(o,e.checkValidity(),t),e.addEventListener("submit",(function(t){t.preventDefault(),e.reset(),console.log("Форма отправляется")})),r(n).forEach((function(n){n.addEventListener("input",(function(){a(o,e.checkValidity(),t),function(e,t,n){var o=e.validity.valid,r=t.querySelector("#".concat(e.name,"-error"));r&&(o?function(e,t,n){e.classList.remove(n.inputErrorClass),t.textContent=""}(e,r,n):function(e,t,n){e.classList.add(n.inputErrorClass),t.textContent=e.validationMessage}(e,r,n))}(n,e,t)}))}))}(t,e)}))}(B)})();